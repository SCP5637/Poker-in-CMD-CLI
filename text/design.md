# Poker-in-CMD-CLI 项目设计文档

## 项目概述
这是一个基于命令行界面的德州扑克游戏实现，使用JavaScript语言开发，可以在命令行或浏览器控制台中运行。

## 目录结构
```
src/
├── core/                   # 核心游戏逻辑
│   ├── Game.js            # 游戏主控制器
│   ├── Player.js          # 玩家类
│   ├── Deck.js            # 扑克牌组类
│   ├── Card.js            # 扑克牌类
│   └── Table.js           # 牌桌类
│
├── poker/                  # 扑克牌相关逻辑
│   ├── HandEvaluator.js   # 牌型判定器
│   ├── HandRanking.js     # 牌型排名定义
│   └── Combinations.js    # 牌型组合计算
│
├── betting/               # 下注系统
│   ├── BettingRound.js   # 下注轮次管理
│   ├── Pot.js            # 奖池管理
│   └── BettingRules.js   # 下注规则
│
├── commands/              # 命令系统
│   ├── CommandParser.js  # 命令解析器
│   ├── CommandExecutor.js # 命令执行器
│   ├── BetCommand.js
│   ├── CallCommand.js
│   ├── RaiseCommand.js
│   ├── FoldCommand.js
│   └── CheckCommand.js
│
├── utils/                # 工具类
│   ├── Logger.js        # 日志工具
│   ├── Validator.js     # 输入验证
│   └── Constants.js     # 常量定义
│
└── interface/           # 界面相关
    ├── CLI.js          # 命令行接口
    └── Display.js      # 显示管理器
```

## 核心类设计

### Game 类
- 管理游戏整体流程
- 控制游戏状态
- 协调各个组件

### Player 类
- 玩家信息管理
- 筹码管理
- 手牌管理

### Table 类
- 管理牌桌状态
- 追踪玩家位置
- 处理公共牌

### Deck 类
- 扑克牌组管理
- 洗牌功能
- 发牌功能

### HandEvaluator 类
- 牌型判定
- 牌力比较
- 最佳牌型计算

### BettingRound 类
- 下注轮次管理
- 下注顺序控制
- 下注规则实施

## 游戏流程

1. 游戏初始化
   - 创建牌桌
   - 玩家入座
   - 设置盲注

2. 回合流程
   - 发手牌
   - 翻牌前下注轮
   - 发翻牌
   - 翻牌圈下注轮
   - 发转牌
   - 转牌圈下注轮
   - 发河牌
   - 河牌圈下注轮
   - 摊牌比较
   - 分配奖池

3. 命令系统
   - bet: 下注
   - call: 跟注
   - raise: 加注
   - fold: 弃牌
   - check: 过牌
   - all-in: 全下

## 技术实现

### 命令行交互
- 使用Node.js的readline模块处理用户输入
- 实现命令解析和执行系统
- 提供清晰的游戏状态显示

### 牌型判定
- 实现所有德州扑克牌型的判定逻辑
- 支持多人牌型比较
- 处理同等牌型的大小比较

### 下注系统
- 支持多人下注
- 处理边池情况
- 实现各种下注规则

## 界面交互设计

### 指令系统设计
1. 指令格式：
   - 三位数字编码 + 指令名称 + 描述
   - 示例：011.Bet-[下注: -{金额}$]

2. 指令分类：
   - 游戏控制指令(000-009)：创建游戏、退出等
   - 游戏操作指令(010-099)：下注、跟注等
   - 设置指令(090-099)：玩家人数、盲注设置等

3. 指令处理流程：
   - 输入捕获 → 指令解析 → 参数验证 → 执行 → 状态更新 → 界面刷新

### 页面渲染机制
1. 动态区域划分：
   - 数据区：游戏状态、玩家信息
   - 公共牌区：当前公共牌
   - 私人牌区：玩家手牌和筹码
   - 结算区：摊牌结果
   - 指令区：可用操作

2. 渲染策略：
   - 基于游戏状态的条件渲染
   - 增量更新优化
   - 异步刷新避免阻塞

### 状态同步设计
1. 数据绑定：
   - 游戏状态 → 界面元素
   - 玩家操作 → 游戏状态更新

2. 事件机制：
   - 状态变更事件
   - 渲染完成事件
   - 用户输入事件

## 后续实现重点
1. 核心交互功能：
   - 完整的指令系统实现
   - 响应式页面渲染
   - 输入验证和错误提示

2. 辅助功能：
   - 游戏设置保存/加载
   - 操作历史记录
   - 上下文帮助系统